<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="645px" preserveAspectRatio="none" style="width:441px;height:645px;background:#FFFFFF;" version="1.1" viewBox="0 0 441 645" width="441px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="626.2344" style="stroke:#A80036;stroke-width:1.0;" width="79" x="1" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51" x="15" y="19.4951">browser</text><rect fill="#DDDDDD" height="626.2344" style="stroke:#A80036;stroke-width:1.0;" width="219" x="117" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62" x="195.5" y="19.4951">extension</text><rect fill="#DDDDDD" height="626.2344" style="stroke:#A80036;stroke-width:1.0;" width="89" x="346" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="53" x="364" y="19.4951">platform</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="40" x2="40" y1="58.9609" y2="638.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="151" x2="151" y1="58.9609" y2="638.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="287" x2="287" y1="58.9609" y2="638.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="390" x2="390" y1="58.9609" y2="638.2344"/><rect fill="#FEFECE" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="71" x="5" y="26.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="12" y="47.8848">webpage</text><rect fill="#FEFECE" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="61" x="121" y="26.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="128" y="47.8848">content</text><rect fill="#FEFECE" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="89" x="243" y="26.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="250" y="47.8848">background</text><rect fill="#FEFECE" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="81" x="350" y="26.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="357" y="47.8848">powershell</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="245.5" x2="287.5" y1="91.3125" y2="91.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="245.5" x2="245.5" y1="91.3125" y2="104.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="245.5" x2="286.5" y1="104.3125" y2="104.3125"/><polygon fill="#A80036" points="278.5,100.3125,288.5,104.3125,278.5,108.3125" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="165.5" y="86.4561">subscribe onConnect</text><line style="stroke:#A80036;stroke-width:1.0;" x1="40.5" x2="82.5" y1="134.6641" y2="134.6641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="82.5" x2="82.5" y1="134.6641" y2="147.6641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="41.5" x2="82.5" y1="147.6641" y2="147.6641"/><polygon fill="#A80036" points="51.5,143.6641,41.5,147.6641,51.5,151.6641" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="47.5" y="129.8076">dispatchEvent()</text><polygon fill="#A80036" points="139.5,174.0156,149.5,178.0156,139.5,182.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40.5" x2="145.5" y1="178.0156" y2="178.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="47.5" y="173.1592">message event</text><line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="193.5" y1="208.3672" y2="208.3672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="193.5" y1="208.3672" y2="221.3672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="152.5" x2="193.5" y1="221.3672" y2="221.3672"/><polygon fill="#A80036" points="162.5,217.3672,152.5,221.3672,162.5,225.3672" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="158.5" y="203.5107">connect()</text><polygon fill="#A80036" points="275.5,247.7188,285.5,251.7188,275.5,255.7188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="151.5" x2="281.5" y1="251.7188" y2="251.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="158.5" y="246.8623">onConnect event</text><line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="193.5" y1="282.0703" y2="282.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="193.5" x2="193.5" y1="282.0703" y2="295.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="152.5" x2="193.5" y1="295.0703" y2="295.0703"/><polygon fill="#A80036" points="162.5,291.0703,152.5,295.0703,162.5,299.0703" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="158.5" y="277.2139">postMessage()</text><polygon fill="#A80036" points="275.5,321.4219,285.5,325.4219,275.5,329.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="151.5" x2="281.5" y1="325.4219" y2="325.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="158.5" y="320.5654">message event</text><line style="stroke:#A80036;stroke-width:1.0;" x1="287.5" x2="329.5" y1="355.7734" y2="355.7734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="329.5" x2="329.5" y1="355.7734" y2="368.7734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="288.5" x2="329.5" y1="368.7734" y2="368.7734"/><polygon fill="#A80036" points="298.5,364.7734,288.5,368.7734,298.5,372.7734" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="294.5" y="350.917">connectNative()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="287.5" x2="329.5" y1="399.125" y2="399.125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="329.5" x2="329.5" y1="399.125" y2="412.125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="288.5" x2="329.5" y1="412.125" y2="412.125"/><polygon fill="#A80036" points="298.5,408.125,288.5,412.125,298.5,416.125" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="294.5" y="394.2686">postMessage()</text><polygon fill="#A80036" points="378.5,438.4766,388.5,442.4766,378.5,446.4766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="287.5" x2="384.5" y1="442.4766" y2="442.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="294.5" y="437.6201">stdin</text><polygon fill="#A80036" points="298.5,468.8281,288.5,472.8281,298.5,476.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="292.5" x2="389.5" y1="472.8281" y2="472.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="304.5" y="467.9717">stdout</text><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="287.5" y1="503.1797" y2="503.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="245.5" y1="503.1797" y2="516.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="286.5" y1="516.1797" y2="516.1797"/><polygon fill="#A80036" points="278.5,512.1797,288.5,516.1797,278.5,520.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="201.5" y="498.3232">postMessage()</text><polygon fill="#A80036" points="162.5,542.5313,152.5,546.5313,162.5,550.5313" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="156.5" x2="286.5" y1="546.5313" y2="546.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="168.5" y="541.6748">message event</text><line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="151.5" y1="576.8828" y2="576.8828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="109.5" y1="576.8828" y2="589.8828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="150.5" y1="589.8828" y2="589.8828"/><polygon fill="#A80036" points="142.5,585.8828,152.5,589.8828,142.5,593.8828" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="62.5" y="572.0264">dispatchEvent()</text><polygon fill="#A80036" points="51.5,616.2344,41.5,620.2344,51.5,624.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="45.5" x2="150.5" y1="620.2344" y2="620.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="57.5" y="615.3779">response event</text><!--MD5=[97ec728a8f57e15aa021661cae9055b4]
@startuml communication

skinparam style strictuml
'skinparam monochrome reverse

box browser
    participant webpage as W
end box
box extension
    participant content as C
    participant background as B
end box
box platform
    participant powershell as P
end box

B <- - B: subscribe onConnect

W -> W: dispatchEvent()
W - -> C: message event

C -> C: connect()
C - -> B: onConnect event
C -> C: postMessage()
C - -> B: message event

B -> B: connectNative()
B -> B: postMessage()
B - -> P: stdin
B <- - P: stdout

B <- B: postMessage()
C <- - B: message event

C <- C: dispatchEvent()
W <- - C: response event

@enduml

@startuml communication

skinparam style strictuml

box browser
    participant webpage as W
end box
box extension
    participant content as C
    participant background as B
end box
box platform
    participant powershell as P
end box

B <- - B: subscribe onConnect

W -> W: dispatchEvent()
W - -> C: message event

C -> C: connect()
C - -> B: onConnect event
C -> C: postMessage()
C - -> B: message event

B -> B: connectNative()
B -> B: postMessage()
B - -> P: stdin
B <- - P: stdout

B <- B: postMessage()
C <- - B: message event

C <- C: dispatchEvent()
W <- - C: response event

@enduml

PlantUML version 1.2022.0(Tue Jan 11 08:16:42 PST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>